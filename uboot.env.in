arch=arm
baudrate=115200
board=dragonboard
board_name=dragonboard
bootcmd=echo ENVCMD; run snappy_boot
bootfile=dragonboard/linux.itb
bootdelay=0
cpu=armv8
dl_kernel=tftp $linux_addr $linux_image && tftp $fdt_addr $fdt_image
dl_ramdisk=tftp $ramdisk_addr $ramdisk_image
dl_uboot=tftp $loadaddr dragonboard/u-boot.img
fdt_addr=0x83000000
fdt_high=0xffffffffffffffff
fdt_image=dragonboard/apq8016-sbc.dtb
fdtfile=apq8016-sbc.dtb
filesize=7a00eb
getargs=fdt addr 0x81e00000; fdt get value args /chosen bootargs
initrd_file=initrd.img
initrd_high=0xffffffffffffffff
initrd_size=7a00eb
ipaddr=10.0.0.2
kernel_file=vmlinuz
linux_addr=0x81000000
linux_image=dragonboard/Image
loadaddr=0x81000000
loadfdt=fatload mmc 1:8 ${fdt_addr} ${snappy_kernel}/dtbs/${fdtfile}
loadfiles=run getargs; run loadkernel; run loadfdt; run loadinitrd
loadinitrd=fatload mmc 1:8 ${ramdisk_addr} ${snappy_kernel}/${initrd_file}; setenv initrd_size ${filesize}
loadkernel=fatload mmc 1:8 ${linux_addr} ${snappy_kernel}/${kernel_file}
mmcargs=setenv bootargs "${args} console=ttyMSM0,115200n8 root=${mmcroot}"
nboot_nord=usb start && run dl_kernel && usb stop && booti $linux_addr - $fdt_addr
nboot_rd=usb start && run dl_kernel && run dl_ramdisk && booti $linux_addr $ramdisk_addr $fdt_addr
netmask=255.255.255.0
ramdisk_addr=0x84000000
ramdisk_image=dragonboard/initrd.img
reflash=mmc dev 0 &&usb start &&tftp $loadaddr dragonboard/rescue/gpt_both0.bin && mmc write $loadaddr 0 43 &&mmc rescan &&part start mmc 0 1 start && part size mmc 0 1 size && tftp $loadaddr dragonboard/rescue/NON-HLOS.bin &&mmc write $loadaddr $start $size &&part start mmc 0 2 start && part size mmc 0 2 size && tftp $loadaddr dragonboard/rescue/sbl1.mbn &&mmc write $loadaddr $start $size &&part start mmc 0 3 start && part size mmc 0 3 size && tftp $loadaddr dragonboard/rescue/rpm.mbn &&mmc write $loadaddr $start $size &&part start mmc 0 4 start && part size mmc 0 4 size && tftp $loadaddr dragonboard/rescue/tz.mbn &&mmc write $loadaddr $start $size &&part start mmc 0 5 start && part size mmc 0 5 size && tftp $loadaddr dragonboard/rescue/hyp.mbn &&mmc write $loadaddr $start $size &&part start mmc 0 6 start && part size mmc 0 6 size && tftp $loadaddr dragonboard/rescue/sec.dat &&mmc write $loadaddr $start $size &&part start mmc 0 7 start && part size mmc 0 7 size && tftp $loadaddr dragonboard/rescue/emmc_appsboot.mbn &&mmc write $loadaddr $start $size &&part start mmc 0 8 start && part size mmc 0 8 size && tftp $loadaddr dragonboard/u-boot.img &&mmc write $loadaddr $start $size &&usb stop &&echo Reflash completed
reflash_uboot=mmc dev 0 &&usb start &&part start mmc 0 8 start && setenv size 0x800  &&tftp $loadaddr dragonboard/u-boot.img &&mmc write $loadaddr $start $size &&usb stop &&echo Reflash completed &&reset
rootpath=/home/nfs/dragonboard
serverip=10.0.0.1
snappy_ab=a
snappy_boot=if test "${snappy_mode}" = "try"; then if test "${snappy_trial_boot}" = "1"; then setenv snappy_os "${snappy_good_os}"; setenv snappy_kernel "${snappy_good_kernel}"; saveenv; else setenv snappy_trial_boot 1; saveenv; fi; elif test "${snappy_mode}" = "recovery"; then run snappy_snappy_recovery_load_recovery_files; setenv mmcroot "/dev/disk/by-label/factory-data ${snappy_cmdline}"; run mmcargs; booti ${linux_addr} ${ramdisk_addr}:${initrd_size} ${fdt_addr} fi; run loadfiles; setenv mmcroot "/dev/disk/by-label/writable ${snappy_cmdline} snappy_os=${snappy_os} snappy_kernel=${snappy_kernel}"; run mmcargs; booti ${linux_addr} ${ramdisk_addr}:${initrd_size} ${fdt_addr}
snappy_cmdline=net.ifnames=0 init=/lib/systemd/systemd ro panic=-1 fixrtc
snappy_mode=restore
snappy_trial_boot=0
snappy_recovery_load_recovery_files=run getargs; run snappy_recovery_loadkernel; run snappy_recovery_loadfdt; run snappy_recovery_loadinitrd
snappy_recovery_loadkernel=fatload mmc 1:9 ${linux_addr} ${kernel_file}
snappy_recovery_loadfdt=fatload mmc 1:9 ${fdt_addr} dtbs/${fdtfile}
snappy_loadinitrd=fatload mmc 1:9 ${ramdisk_addr} ${initrd_file}; setenv initrd_size ${filesize}
soc=apq8016
stderr=serial
stdin=serial
stdout=serial
test=run test_mmc && run test_sd && run test_sdm && run test_network && reset
test_mmc=mmc dev 0 && mmc erase 71020 1 && mmc write 0xBD956000 71020 1&& mmc read $fdt_addr 71020 1 && cmp.b 0xBD956000 $fdt_addr 200
test_network=usb start && dhcp; usb stop
test_sd=mmc dev 1 && mmc erase 61460 1 && mmc write 0xBD956000 61460 1&& mmc read $fdt_addr 61460 1 && cmp.b 0xBD956000 $fdt_addr 200
test_sdm=mmc dev 1 && mmc erase 61460 8 && mmc write 0xBD956000 61460 8&& mmc read $fdt_addr 61460 8 && cmp.b 0xBD956000 $fdt_addr 1000
time_mmc=mmc dev 0; timer start; mmc read $loadaddr 0 5000; timer get
time_sd=mmc dev 1; timer start; mmc read $loadaddr 0 5000; timer get
vendor=qcom
